# GitHub Actions Workflows

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ CI/CD –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ Workflows

### üß™ CI (ci.yml)
**–¢—Ä–∏–≥–≥–µ—Ä—ã:** Push –∏ Pull Request –≤ –≤–µ—Ç–∫–∏ `main`, `master`, `develop`

**–ó–∞–¥–∞—á–∏:**
- **Test Job:** –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏—è—Ö Go (1.21, 1.22, 1.23)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (`go mod verify`)
  - –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (`go build`)
  - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å race detector –∏ coverage (`go test -race -coverprofile`)
  - –ó–∞–≥—Ä—É–∑–∫–∞ coverage –≤ Codecov (—Ç–æ–ª—å–∫–æ –¥–ª—è Go 1.23)
- **Build Job:** –°–±–æ—Ä–∫–∞ CLI —É—Ç–∏–ª–∏—Ç—ã `tdtpcli`
  - –ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–∏–Ω–∞—Ä–Ω–∏–∫–∞
  - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã CLI

**–°—Ç–∞—Ç—É—Å:** ![CI](https://github.com/queuebridge/tdtp/actions/workflows/ci.yml/badge.svg)

---

### üîç Lint (lint.yml)
**–¢—Ä–∏–≥–≥–µ—Ä—ã:** Push –∏ Pull Request –≤ –≤–µ—Ç–∫–∏ `main`, `master`, `develop`

**–ó–∞–¥–∞—á–∏:**
- **golangci-lint Job:** –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é golangci-lint
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `.golangci.yml`
  - Timeout: 5 –º–∏–Ω—É—Ç
- **gofmt Job:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤–µ—Å—å –∫–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω
  - –í—ã–≤–æ–¥–∏—Ç diff –¥–ª—è –Ω–µ–æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **govet Job:** –ê–Ω–∞–ª–∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
  - –ó–∞–ø—É—Å–∫ `go vet` –¥–ª—è –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ![Lint](https://github.com/queuebridge/tdtp/actions/workflows/lint.yml/badge.svg)

---

### üîí Security (security.yml)
**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Push –∏ Pull Request –≤ –≤–µ—Ç–∫–∏ `main`, `master`, `develop`
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º –≤ 00:00 UTC (cron)

**–ó–∞–¥–∞—á–∏:**
- **govulncheck Job:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Go
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `govulncheck`
  - –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- **dependency-review Job:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è PR)
  - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
  - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- **nancy Job:** –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å Nancy
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç Sonatype
  - Continue-on-error –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ![Security](https://github.com/queuebridge/tdtp/actions/workflows/security.yml/badge.svg)

---

### üöÄ Release (release.yml)
**–¢—Ä–∏–≥–≥–µ—Ä—ã:** Push —Ç–µ–≥–æ–≤ –≤–∏–¥–∞ `v*.*.*` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `v1.2.0`)

**–ó–∞–¥–∞—á–∏:**
- –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- –°–±–æ—Ä–∫–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º:
  - Linux (amd64, arm64)
  - Windows (amd64)
  - macOS (amd64, arm64)
- –°–æ–∑–¥–∞–Ω–∏–µ SHA256 checksums
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ GitHub Release —Å:
  - –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞–º–∏
  - Checksums —Ñ–∞–π–ª–æ–º
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ release notes

**–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑:**
```bash
git tag -a v1.2.0 -m "Release v1.2.0"
git push origin v1.2.0
```

**–°—Ç–∞—Ç—É—Å:** ![Release](https://github.com/queuebridge/tdtp/actions/workflows/release.yml/badge.svg)

---

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### golangci-lint (.golangci.yml)
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–Ω—Ç–µ—Ä–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- **–ë–∞–∑–æ–≤—ã–µ:** errcheck, gosimple, govet, ineffassign, staticcheck, unused
- **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** gofmt, goimports
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** revive, gocritic, misspell
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** gosec
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** prealloc
- **–ü—Ä–æ—á–µ–µ:** unconvert, unparam, exportloopref, nilerr, bodyclose

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Go:** 1.21
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è Go:** 1.23
- **Timeout –¥–ª—è —Ç–µ—Å—Ç–æ–≤:** 2 –º–∏–Ω—É—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ CI)
- **Timeout –¥–ª—è –ª–∏–Ω—Ç–µ—Ä–∞:** 5 –º–∏–Ω—É—Ç

---

## üìä Badges –¥–ª—è README

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à README.md:

```markdown
![CI](https://github.com/queuebridge/tdtp/actions/workflows/ci.yml/badge.svg)
![Lint](https://github.com/queuebridge/tdtp/actions/workflows/lint.yml/badge.svg)
![Security](https://github.com/queuebridge/tdtp/actions/workflows/security.yml/badge.svg)
[![codecov](https://codecov.io/gh/queuebridge/tdtp/branch/main/graph/badge.svg)](https://codecov.io/gh/queuebridge/tdtp)
```

---

## üîß –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ
```bash
go test -v -race -coverprofile=coverage.txt ./...
```

### –ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ golangci-lint
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# –ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞
golangci-lint run
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
gofmt -s -l .
```

### –ó–∞–ø—É—Å–∫ govulncheck –ª–æ–∫–∞–ª—å–Ω–æ
```bash
go install golang.org/x/vuln/cmd/govulncheck@latest
govulncheck ./...
```

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ `go fmt ./...`
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ `go vet ./...`
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã `go test ./...`

2. **–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PR:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–∏–Ω—Ç–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ coverage (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ > 70%)

3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞:**
   - –û–±–Ω–æ–≤–∏—Ç–µ CHANGELOG.md
   - –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–≥ —Å –≤–µ—Ä—Å–∏–µ–π
   - GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Ä–µ–ª–∏–∑

---

## üêõ Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** CI —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Go
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`go mod tidy`)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç race conditions (`go test -race`)

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏–Ω—Ç–µ—Ä –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫–∏
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `golangci-lint run` –ª–æ–∫–∞–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.golangci.yml` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ `issues.exclude-rules`

**–ü—Ä–æ–±–ª–µ–º–∞:** Security workflow –Ω–∞—Ö–æ–¥–∏—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `go get -u ./...`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —Å `govulncheck`
- –ï—Å–ª–∏ —ç—Ç–æ false positive, –¥–æ–±–∞–≤—å—Ç–µ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [golangci-lint Linters](https://golangci-lint.run/usage/linters/)
- [Go Vulnerability Database](https://vuln.go.dev/)
